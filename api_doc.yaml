openapi: 3.0.0

servers:
  - description: API Server
    url: localhost:8080/

info: 
  description: EyeConnection APIs reference
  version: "2.0.0"
  title: EyeConnection service APIs

tags:
  - name: user
    description: Available to users
  - name: doctor
    description: Available to doctors
  - name: system
    description: Available to system

paths:
  /sign_up:
    post:
      description: create new users in system
      tags: 
      - user
      requestBody:
        content:
          application/json:
            schema:
              properties:
                email:
                  type: string
                  example: example@email.com
                password:
                  type: string
                  example: password123
                lastName:
                  type: string
                  example: White
                firstName:
                  type: string
                  example: Mike
                zipCode:
                  type: integer
                  example: 10011
        required: true
      responses:
        "201":
          description: successfully created new user
        "202":
          description: created new user failed

  /user_log_in:
    post:
      description: users log into system
      tags: 
      - user
      requestBody:
        content:
          application/json:
            schema:
              properties:
                email:
                  type: string
                  example: example@email.com
                password:
                  type: string
                  example: password123
        required: true
      responses:
        "200":
          description: successfully log in
        "401":
          description: log in failed
  
  /doctor_log_in:
    post:
      description: users log into system
      tags: 
      - doctor
      requestBody:
        content:
          application/json:
            schema:
              properties:
                email:
                  type: string
                  example: example@email.com
                password:
                  type: string
                  example: password123
        required: true
      responses:
        "200":
          description: successfully log in
        "401":
          description: log in failed
  
  /update_available_time:
    put:
      description: update available time for doctors
      tags:
      - doctor
      requestBody:
        content:
          application/json:
            schema:
              properties:
                sys_id: 
                  type: string
                  example: EA930233
                available_date:
                  type: array
                  example: ["2023-03-20", "2023-03-21"]
      responses:
        "200":
          description: update available time successfully

  /confirm_appointment:
    post:
      description: confirm appointment request
      tags: 
      - doctor
      requestBody:
        content:
          application/json:
           schema:
            properties:
              appointment_id:
                type: string
                example: AP123456
              doctor_sys_id: 
                type: string
                example: EA930233
              patient_sys_id:
                type: string
                example: EA930233
              appointment_status:
                type: string
                example: Finished, Pending, Approved, Cancelled
              online:
                type: boolean
                example: true
              online_meeting:
                type: string
                example: "https://zoom.us/13edfeerc"
              appointment_date:
                example: "2023-01-03 13:00"
              confirmation_date:
                example: "2023-01-01 12:00"
              address:
                type: string
                example: "1st Memories St, San Francisco, CA"
              patient_email:
                type: string
                example: "hokey@gmail.com"
              patient_phone:
                type: string
                example: "201-111-2342"
              doctor_email:
                type: string
                example: "green@gmail.com"
              doctor_phone:
                type: string
                example: "201-111-2342"
              notes:
                type: string
                example: "No eating after 8:00 PM"
      responses:
        "200":
          description: Confiem appointment successfully

  /search_by_condition:
    post:
      description: user search available doctors according to conditions
      tags:
      - system
      requestBody:
        content:
          application/json:
            schema:
              properties:
                city:
                  type: string
                  example: Boston
                state:
                  type: string
                  example: MA
                zip_code:
                  type: integer
                  example: 10011
                category:
                  type: string
                  example: Dentist
                support_online:
                  type: boolean
                  example: true
                available_date:
                  type: array
                  example: {"03-01-2015", "03-02-2015"}
      responses:
        "200":
          description: results of user search
          content: 
            application/json:
              schema:
                properties:
                  doctors_list:
                    type: array
                    items:
                      type: object
                      properties:
                        email:
                          type: string
                        last_name:
                          type: string
                        first_name:
                          type: string
                        rate:
                          type: integer
                        address:
                          type: string
                        city:
                          type: string
                        state:
                          type: string
                        available_date:
                          type: array
                        role:
                          type: string
                        portrait:
                          type: string
                        support_online:
                          type: boolean
                    example:
                      - email: green.white@gmail.com
                        last_name: white
                        first_name: green
                        rate: 5.0
                        address: 101th Street, Building 1
                        city: Boston
                        state: MA
                        available_date: ["2023-01-01 13:00", "2023-02-02 13:00"]
                        role: Dentist
                        portrait: "/portrait_img/Ek2789fbh"
                        support_online: true
                      - email: david.wang@gmail.com
                        last_name: wang
                        first_name: david
                        rate: 4.1
                        address: 11th Street, Building 2
                        city: Boston
                        state: MA
                        available_date: ["2023-01-01 13:00", "2023-02-02 13:00"]
                        role: Optometryist
                        portrait: "/portrait_img/AKING2877"
                        support_online: false

  /make_appointment:
    post:
      description: a patient make an appointment with a doctor
      tags:
      - user
      requestBody:
        content:
          application/json:
            schema:
              properties:
                patient_id:
                  type: string
                  example: EA912239
                doctor_id:
                  type: string
                  example: EA912233
                appointment_date:
                  example: "2023-01-01 13:00"
                online:
                  type: boolean
                  example: true
      responses:
        "200":
          description: make an appointment successfully

  /all_appointments?sysid={sysid}:
    get:
      description: show all appointments
      parameters:
      - in: path
        name: sysid
        schema:
          type: string
        required: true
      tags:
      - system
      responses:
        "200":
          description: show appointment information
          content: 
            application/json:
              schema:
                properties:
                  appointments:
                    type: array
                    example: ["appointment1", "appointment2", "appointment3"]

  /appointments_details?appointment_id={appointment_id}:
    get:
      description: show appointment details
      parameters:
      - in: path
        name: appointment_id
        schema:
          type: string
        required: true
      tags:
      - system
      responses:
        "200":
          description: show appointment details
          content: 
            application/json:
              schema:
                $ref: '#/components/schemas/appointment'

  /profile?sysid={sysid}:
    get:
      description: get profile information for rendering
      parameters:
      - in: path
        name: sysid
        schema:
          type: string
        required: true
      tags:
      - system
      responses:
        "200":
          description: show profile information
          content:
            application/json:
              schema:
                properties:
                  email:
                    type: string
                    example: green@gmail.com
                  lastName:
                    type: string
                    example: White
                  firstName:
                    type: string
                    example: Mike
                  portrait:
                    type: string
                    example: "/green-wiley-portrait"
            
  /notification:
    post:
      description: push a notification to the taget user or doctor according to the sys_id
      tags: 
      - system
      responses:
          "200":
            description: push a notification successfully

  /update_appointment_status:
    put:
      description: update the status of an appointment
      tags:
      - system
      requestBody:
        content:
          application/json:
            schema:
              properties:
                appointment_id:
                  type: string
                  example: EA930233
                new_status:
                  type: string
                  example: Canceled
      responses:
        "204":
          description: update the status successfully

components:
  schemas:
    user:
      properties:
        sysId:
          type: integer
          example: 22
        email:
          type: string
          example: example@email.com
        password:
          type: string
          example: password123
        lastName:
          type: string
          example: White
        firstName:
          type: string
          example: Mike
        zipCode:
          type: integer
          example: 10011

    doctor:
      properties:
        sys_id:
          type: string
          example: 0023AET9
        email:
          type: string
          example: example@email.com
        password:
          type: string
          example: password123
        last_name:
          type: string
          example: Green
        first_name:
          type: string
          example: Wiley
        zip_code:
          type: integer
          example: 10011
        rate:
          type: integer
          example: 4.8
        address:
          type: string
          example: 106th Street, Building 1st
        city:
          type: string
          example: Boston
        state:
          type: string
          example: MA
        available_date:
          type: array
          example: {"03-01-2015", "03-02-2015", "03-03-2015"}
        role:
          type: string
          example: Dentist
        portrait:
          type: string
          example: "/green-wiley-portrait"
        support_online:
          type: boolean
          example: true
    
    appointment:
      properties:
              appointment_id:
                type: string
                example: AP123456
              doctor_sys_id: 
                type: string
                example: EA930233
              patient_sys_id:
                type: string
                example: EA930233
              appointment_status:
                type: string
                example: Finished, Pending, Approved, Cancelled
              online:
                type: boolean
                example: true
              online_meeting:
                type: string
                example: "https://zoom.us/13edfeerc"
              appointment_date:
                example: "2023-01-03 13:00"
              confirmation_date:
                example: "2023-01-01 12:00"
              address:
                type: string
                example: "1st Memories St, San Francisco, CA"
              patient_email:
                type: string
                example: "hokey@gmail.com"
              patient_phone:
                type: string
                example: "201-111-2342"
              doctor_email:
                type: string
                example: "green@gmail.com"
              doctor_phone:
                type: string
                example: "201-111-2342"
              notes:
                type: string
                example: "No eating after 8:00 PM"